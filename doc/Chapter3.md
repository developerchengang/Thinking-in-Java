# 操作符

## 赋值

赋值使用操作符`=`。意思是取右边的值，赋值给左边的常量、变量或者表达式。

基本数据类型赋值时，是直接将内容复制到另外一块内存空间，修改任意一个变量的值不会影响到另外一个变量。示例：

```java
int a = 5;
int b = a; // 表示将a变量的值5复制到b变量的内存地址空间
a = 10;
// 输出结果：a等于10，b等于5。修改a的值不会影响到b的值

```

引用类型赋值时，是将右边的引用赋值给左边的变量。修改其中一个变量会影响另外一个变量。示例

```java
class Tank {
    int level;
}

Tank tank1 = new Tank();
tank1.level = 5;

Tank tank2 = new Tank();
tank2.level = 8;

tank2 = tank1; // 将tank1的引用赋值给tank2，此时两个变量指向的是同一块内存空间
tank2.level = 10; // 修改值
// 输出结果：tank1.level、tank2.level都等于10

```



## 算术运算符

Java基本算术包括加（`+`）、减（`-`）、除（`/`）、乘（`*`） 以及取模操作符（`%`）。整数除法会直接去掉小数位。

```java
int a = 5;
int b = 11;
int c;

// 加法
c = a + b; // c等于16

// 减法
c = b - a; // c等于6

// 除法
c = b / a; // c等于2，因为c是整形，所以去掉小数位

// 乘法
c = a * b; // c等于55

// 取模
c = b % a; // c等于1
```

## 优先级

算术运算符一般情况下从左向右先乘除取模后加减，如果遇到小括号，先运算小括号里面的值。这里只讨论算术运算符优先级其他运算符优先级可以参考[Java运算符优先级](<http://www.cnblogs.com/gw811/archive/2012/10/13/2722752.html>)

```java
int x = 1, y = 2, z = 3;
int x = 1, y = 2, z = 3;
int c = x + y - y*z + z; // 先运算y*z=6，再x+y=3，然后3-6=-3，最后-3+3=0
int d = x + (y-y)*z + z; // 先运算括号(y-y)=0，再0*z=0，然后x+0=1，最后1+3=4 
```

## 自动递增自动递减

递增操作符`++`，意为增加一个单位，递减操作符`--`意为减少一个单位。

```java
int a;
a++ // 等价于 a = a + 1
```

递增、递减又分为`前缀式`和`后缀式`。前缀式表示先递增（递减）再赋值；后缀式先赋值后递增（递减）

```java
// 前缀式
int a = 1;
int b = ++a; // 等价于 int b = a + 1;
// 输出结果为：a = 2; b = 2

//后缀式
int x = 1;
int y = x++; // 等价于 int y = x;
//　输出结果为：x = 2; y = 1
```

## 关系操作符

关系操作符生成的是一个boolean结果，要么为真要么为假。关系操作符包括（小于）`<`、（大于）`>`、（小于等于）`<=`、（大于等于）`>=`、（等于）`==`、（不等于）`!=`。==或者!=可以比较两个基本数据类型是否相等或者不相等，一般用于比较引用类型。`==`比较两个变量内存地址。

```java
int a = 2, b= 3;
boolean result;
// <
result = a < b; // true
// >
result = a > b;// false
// <=
result = a　<= b; // true
// >=
result = a >= b; // false
// == 
result = a == b; // false
// !=
result = a != b; // true

//　比较引用类型
Integer i1 = new Integer();
Integer i2 = new Integer();
result = i1 == i2; // false
result = i1 != i2; // true
// 因为 i1和i2内存地址不同所以不相等
```

## 逻辑操作符

逻辑操作符（与）`&&`、（或）`||`、（非）`!`能根据参数的逻辑关系，生成一个boolean值。

### 与（&&）

表达式都为true即为true，否则为false

```java
int a = 2, b = 3;
print(a<b && b>a); // 都为true，结果为true
print(a<b && b<a); // (b<a)为false，结果为false
```

### 或（||）

只要一个表达式为true即为true，都为false则为false

```java
int a = 2, b = 3;
print(a<b || b>a); // true　（a<b）和(b>a)的值都为true，结果为true
print(a<b || b<a); // true　（a<b）值为true，结果为true
print(a>b || b<a); // false　值都为false，结果为false
```

### 非（!）

取表达式结果的相反值，true取反为false，false取反为true

```java
int a = 2, b = 3;
print(!(a<b)); // (a<b)值为true，取反为false
print(!(b<a)); // (b<a)值为false，取反为true
```

### 短路

一旦能够明确无误整个表达式的值，就不再计算表达式余下部分。

```java
int a = 2, b = 3;
print(a>b && b>a); // (a>b)为false，短路不再执行(b>a)
print(a<b && b<a); // (a<b)为true，短路不再执行(b<a)
```

## 直接常量

在程序使用数字类型变量，一般使用十进制表示法。假设一个`int`类型需要赋值一个十六进制值就需要额外增加特性符号表示。

``` java
int a = 10; // 十进制10
int b = 0xa; // 十六进制10
```

### 指数记数法

在科学与工程领域`e`代表自然对数的基数，约等于2.718。例如1.39×2.718[^-43]。然而，设计`FORTRAN`语言的时候，设计师们决定`e`代表`10的幂次`。这种惯例在`C`、`C++`以及`Java`中被保留了下来。所以在Java中看到`1.39E-43F`这样的表达式时，它真正的含义是1.39×10[^-43]。

如果在含混不清楚的地方，编译器通常会将指数作为双精度（double）处理，假如没有这个尾部的F，就会提示错误。

```java
float f = 1e-43; // 编译报错
float f2 = 1e-43f; // 正确
```

## 按位操作符

按位操作符用来操作整数基本数据类型中的单个（比特）`bit`，即二进制位。按位操作符会对两个参数中对应的位执行布尔代数运算，并最终生成一个结果。按位操作符（与）`&`、（或）`|`、（异或）`^`、（非）`~`。

### 与（&）

如果两个输入位都是1，则按位`&`生成一个输出位1，否则生成一个输出位0。

```java
// 1011 & 1101 = 1001
int i1 = 11; // 二进制1011
int i2 = 13; // 二进制1101
int i3 = i1 & i2; // i1 & i2 结果为：1001
```

### 或（|）

两个输出位只要一个是1，则按位`｜`生成一个输出为1；只有在两个输出位都是0的情况下，它才生成一个输出位0。

```java
// 1001 | 1101 = 1101
int i1 = 9;  // 二进制1001
int i2 = 13; // 二进制1101
int i3 = i1 | i2; // i1 & i2 结果为：1101
```

### 异或（^）

如果输出位的其中一个是1，并且不全是1，那么`^`生成一个输出位1，否则输出位0。

```java
// 1011 & 1101 = 0110
int i1 = 11; // 二进制1011
int i2 = 13; // 二进制1101
int i3 = i1 ^ i2; // i1 ^ i2 结果为：0110
```

### 非（~）

取反操作符，属于一元操作符，只对一个操作数进行操作（其他按位操作符是二元操作符）。`~`生成与输出位相反的值，若输入0，输出1；若输入1，则输出0。

```java
// ~1011 = 0100
int i1 = 11; // 1011
int i2 = ~i1; // ~1011 结果为：1111 1111 1111 1111 1111 1111 1111 0100
```

注意：由于int类型是32位，所以高位取反为1

## 移位操作符

移位操作符操作的运算对象也是二进制的位。移位操作符只可以用来处理整数类型。如果对`char`、`short`、`byte`进行移位操作，那么在移位之前，它们会被转换为`int`类型，并且得到的结果也为`int`类型。	

### 左移位操作符（<<）

左移位操作符（`<<`）按照操作符右侧指定的位数将（低位）左边的操作数向左（高位）移动（低位补0）

``` java
int i = 5; // 二进制：101
int a = i << 1; // 将101向左移动1位，低位补一个0。结果为：1010
int b = i << 2; // 将101向左移动2位，低位补两个0。结果为：10100
```

### 有符号右移操作符（>>）

有符号右移位操作符（`>>`）按照操作符右侧指定的位数将（低位）左边的操作数向右（低位）移动。有符号右移操作符使用符号扩展：正整数，高位补0；负整数，高位补1。

### 正整数高位补零

```java
int i = 5; // 二进制：101
int a = i >> 1; // 将101向右移动1位，高位补一个0。结果为：010
int b = i >> 2; // 将101向右移动2位，高位补两个0。结果为：001
```

### 负整数高位补1

```java
int i = -5; // 二进制：1111 1111 1111 1111 1111 1111 1111 1011
int a = i >> 1; // 将-5向右移动1位，高位补一个1。结果为：1111 1111 1111 1111 1111 1111 1111 1101
int b = i >> 2; // 将-5向右移动两位，结果为：1111 1111 1111 1111 1111 1111 1111 1110
```

### 无符号右移操作符（>>>）

Java增加的一种无符号操作符（`>>>`），它使用`零扩展`：无论正负数，高位一律补0。C、C++没有该操作符。

```java
int i = -5; // 二进制：1111 1111 1111 1111 1111 1111 1111 1011
int a = i >>> 1; // 结果为：0111 1111 1111 1111 1111 1111 1111 1101
int b = i >>> 2; // 结果为：0011 1111 1111 1111 1111 1111 1111 1110
```

### char类型移位

``` java
char c = ‘A’；// 二进制：1000001
int a = c >> 1; // 自动转换为int类型，结果为：0100000
int b = c << 1; // 自动转换为int类型，结果为：10000010

```

移位操作符可以赋值组合使用（`<<=`或者`>>>=`）。操作符左边的值会移动由右边的值指定的位数，再将得到的结果赋给左边的变量。但是无符号右移结合赋值操作时，可能会遇到问题，如果对`byte`、`short`值进行这样的移位运算，得到的可能不是正确的结果，它们会先被转换成`int`类型，再进行右移操作，然后赋值给原来的类型，由于原来类型可能装不下移位之后的值，导致被截断，得到不正确的值。

```java
short s = -5;
s >>> 2; // 错误结果为：1111　1111　1111　1111　1111　1111　1111　1110
int i = s >>> 2; // 正确结果应该为：0011　1111　1111　1111　1111　1111　1111　1110        
```

## 三元操作符

三元操作符也称为条件操作符，它有三个操作数。如果表达式值为`true`执行`?`后面表达式，否则执行`:`后面表达式。三元操作符可读性相比`if-else`差，一般情况不建议使用。

```java
int a = 2;
int b = 3;
boolean result = (a > b) ? true : false; // result值为true
```

## 字符串操作符

`+`、`+=`在字符串中有一项特殊的用途；连接不同的字符串。如果表达式以字符串起头，那么后续所有操作数都编译器自动转换成字符串。

```java
int a = 2, b = 3;
String s = "a + b = ";
String result = s + a + b; // result值为： a + b = 23
```

## 类型转换操作符

### 自动类型转换

在适当的时候，Java会将一种数据类型自动转换成另外一种数据类型，称之为自动类型转换（或者向上转换，类型小的转换为类型大的）。比如`int`会自动转换为`long`，因为`int`存储空间比`long`小。

```java
int i = 100;
long l = i; // 自动转换
```

### 强制类型转换

也可以把一种类型强制转换为另外一种类型（或者向下转换，类型大的转换为类型小的）。强制转换有可能导致部分数据丢失，比如`float`转换成`int`，由于`float`是单精度类型转换`int`会丢失小数点后面的小数。

``` java
float f = 3.1415f;
int i = (int) f; // 强制转换，i = 3，后面小数位丢失
```



